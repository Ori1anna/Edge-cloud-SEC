# Edge vs Cloud Baseline å¯¹æ¯”åˆ†æ

## é—®é¢˜æè¿°

æ‚¨çš„æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼š
- **Edge (CPU-limited, 3B)**: BLEU=0.0305, CIDEr=0.5097
- **Cloud (GPU, 7B)**: BLEU=0.0239, CIDEr=0.4967

**åç›´è§‰**ï¼šæ›´å¤§çš„Cloudæ¨¡å‹ï¼ˆ7Bï¼‰åè€Œæ¯”å°çš„Edgeæ¨¡å‹ï¼ˆ3Bï¼‰åœ¨BLEUå’ŒCIDErä¸Šè¡¨ç°æ›´å·®ï¼

---

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### é—®é¢˜1: **Edgeæ¨¡å‹ç”Ÿæˆäº†å¯¹è¯å¼å†…å®¹**

#### Edgeè¾“å‡ºç¤ºä¾‹ï¼ˆsample_00000000ï¼‰

```
"è¯´è¯äººçš„å£°éŸ³æœ‰äº›ä½æ²‰ï¼ŒéŸ³é«˜å˜åŒ–ä¸å¤§ï¼Œè¯­æ°”å¹³ç¼“ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åœé¡¿æ—¶æ–­ï¼Œæ•´ä½“ç»™äººä¸€ç§å¹³é™çš„æ„Ÿè§‰ã€‚ä»–å¯èƒ½æ˜¯åœ¨è¡¨è¾¾ä¸€ç§æ— å¥ˆçš„æƒ…ç»ªã€‚ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•æˆ–è€…æƒ³è¡¥å……çš„ï¼Œéšæ—¶è·Ÿæˆ‘è¯´å“ˆã€‚"
```

**é—®é¢˜**ï¼š
- âŒ **åŒ…å«å¯¹è¯å¼è¯­å¥**ï¼š"ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•æˆ–è€…æƒ³è¡¥å……çš„ï¼Œéšæ—¶è·Ÿæˆ‘è¯´å“ˆã€‚"
- âŒ **ä¸ç¬¦åˆä»»åŠ¡è¦æ±‚**ï¼šåº”è¯¥æ˜¯å®¢è§‚æè¿°ï¼Œä¸æ˜¯ä¸ç”¨æˆ·å¯¹è¯
- âŒ **ä½†ä¸referenceæœ‰n-gramé‡å **ï¼šå¯èƒ½å¶ç„¶åŒ¹é…äº†referenceä¸­çš„æŸäº›è¯

#### Cloudè¾“å‡ºç¤ºä¾‹ï¼ˆsample_00000000ï¼‰

```
"è¯´è¯äººçš„è¯­æ°”å¬èµ·æ¥æœ‰äº›æ— å¥ˆå’Œå›°æƒ‘ï¼Œåƒæ˜¯åœ¨å›åº”åˆ«äººçš„é—®é¢˜æ—¶å‘ç°è‡ªå·±å¹¶ä¸æ¸…æ¥šç­”æ¡ˆã€‚ä»–çš„è¯è¯­é—´ä¼¼ä¹å¸¦ç€ä¸€ä¸ç´§å¼ ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªé—®é¢˜å¯¹ä»–æ¥è¯´ç¡®å®æ¯”è¾ƒæ£˜æ‰‹ã€‚"
```

**ç‰¹ç‚¹**ï¼š
- âœ… **å®Œå…¨å®¢è§‚æè¿°**
- âœ… **ç¬¦åˆä»»åŠ¡è¦æ±‚**
- âœ… **ä½†BLEU/CIDEråè€Œæ›´ä½**

---

### é—®é¢˜2: **Edgeæ¨¡å‹æ²¡æœ‰ä½¿ç”¨Stopping Criteria**

#### Edgeæ¨¡å‹ä»£ç ï¼ˆ`edge_model.py`ï¼‰

```python
# ç¬¬202-210è¡Œ
outputs = self.model.generate(
    **inputs,
    max_new_tokens=max_new_tokens,
    temperature=temperature,
    top_p=top_p,
    do_sample=False,  # è´ªå¿ƒè§£ç 
    no_repeat_ngram_size=2,
    repetition_penalty=1.05,
    pad_token_id=self.processor.tokenizer.eos_token_id,
    # âŒ æ²¡æœ‰ stopping_criteriaï¼
)
```

**åæœ**ï¼š
- Edgeæ¨¡å‹ä¼šæŒç»­ç”Ÿæˆç›´åˆ° `max_new_tokens=64` æˆ– é‡åˆ°EOS token
- æ— æ³•æŒ‰ç…§"2å¥è¯"çš„è¦æ±‚åœæ­¢
- ç”Ÿæˆäº†å¤šä½™çš„å¯¹è¯å¼å†…å®¹

#### Cloudæ¨¡å‹ä»£ç ï¼ˆ`cloud_model.py`ï¼‰

```python
# ç¬¬121-127è¡Œ
from .stopping_criteria import create_stopping_criteria
stopping_criteria = create_stopping_criteria(
    self.processor.tokenizer,
    n_sentences=2,  # âœ… é™åˆ¶2å¥è¯
    sentence_end_chars=("ã€‚", "."),
    min_new_tokens=32,
    prompt_type=prompt_type
)

# ç¬¬212-219è¡Œ
outputs = self.model.generate(
    **inputs,
    max_new_tokens=max_new_tokens,
    temperature=adjusted_temperature,
    top_p=adjusted_top_p,
    do_sample=do_sample,
    no_repeat_ngram_size=no_repeat_ngram_size,
    repetition_penalty=repetition_penalty,
    stopping_criteria=stopping_criteria,  # âœ… ä½¿ç”¨stopping criteria
    pad_token_id=self.processor.tokenizer.eos_token_id,
)
```

**ä¼˜åŠ¿**ï¼š
- Cloudæ¨¡å‹åœ¨ç”Ÿæˆ2å¥è¯åä¼šåœæ­¢
- è¾“å‡ºæ›´åŠ ç®€æ´ã€ç¬¦åˆä»»åŠ¡è¦æ±‚
- ä½†BLEU/CIDEråè€Œæ›´ä½ï¼

---

### é—®é¢˜3: **ç”Ÿæˆå‚æ•°ä¸ä¸€è‡´**

| å‚æ•° | Edge | Cloud | å½±å“ |
|------|------|-------|------|
| **do_sample** | False (è´ªå¿ƒ) | False (è´ªå¿ƒ) | âœ… ä¸€è‡´ |
| **no_repeat_ngram_size** | 2 | 2 | âœ… ä¸€è‡´ |
| **repetition_penalty** | 1.05 | 1.05 | âœ… ä¸€è‡´ |
| **stopping_criteria** | âŒ æ—  | âœ… 2å¥è¯+32 tokens | âŒ **ä¸ä¸€è‡´** |
| **max_new_tokens** | 64 | 120 | âŒ **ä¸ä¸€è‡´** |

---

### é—®é¢˜4: **BLEU/CIDEræŒ‡æ ‡çš„å±€é™æ€§**

#### ä¸ºä»€ä¹ˆEdgeçš„BLEU/CIDEræ›´é«˜ï¼Ÿ

**BLEU/CIDErçš„ç‰¹æ€§**ï¼š
- åŸºäº**n-gramåŒ¹é…**ï¼ˆ1-gram, 2-gram, 3-gram, 4-gramï¼‰
- æ›´é•¿çš„è¾“å‡ºæœ‰æ›´å¤šæœºä¼šåŒ¹é…reference

**Edgeçš„ä¼˜åŠ¿ï¼ˆä½†è¿™æ˜¯é”™è¯¯çš„ä¼˜åŠ¿ï¼‰**ï¼š

```python
# Edgeè¾“å‡ºï¼ˆ63ä¸ªtokenï¼‰
"...ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•æˆ–è€…æƒ³è¡¥å……çš„ï¼Œéšæ—¶è·Ÿæˆ‘è¯´å“ˆã€‚"

# Referenceå¯èƒ½åŒ…å«ç±»ä¼¼çš„è¯æ±‡
"...æƒ³æ³•"ã€"è¯´"ã€"..."

# ç»“æœï¼šæ›´å¤šn-gramåŒ¹é… â†’ BLEU/CIDEræ›´é«˜
```

**Cloudçš„åŠ£åŠ¿ï¼ˆä½†è¿™æ˜¯æ­£ç¡®çš„è¾“å‡ºï¼‰**ï¼š

```python
# Cloudè¾“å‡ºï¼ˆ38ä¸ªtokenï¼Œæ›´ç®€æ´ï¼‰
"...ä»–çš„è¯è¯­é—´ä¼¼ä¹å¸¦ç€ä¸€ä¸ç´§å¼ ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªé—®é¢˜å¯¹ä»–æ¥è¯´ç¡®å®æ¯”è¾ƒæ£˜æ‰‹ã€‚"

# æ›´ç®€æ´ï¼Œæ›´ç¬¦åˆä»»åŠ¡è¦æ±‚
# ä½†n-gramåŒ¹é…æœºä¼šå‡å°‘ â†’ BLEU/CIDEræ›´ä½
```

---

## ğŸ“Š æ•°æ®å¯¹æ¯”

### å¹³å‡è¾“å‡ºé•¿åº¦

| æ¨¡å‹ | å¹³å‡tokens | å¹³å‡å­—ç¬¦ | ç‰¹ç‚¹ |
|------|------------|----------|------|
| **Edge** | 50.35 | ~70-80 | åŒ…å«å¯¹è¯å¼å†…å®¹ï¼Œè¾ƒé•¿ |
| **Cloud** | 51.65 | ~70-80 | ç®€æ´å®¢è§‚ï¼Œç¬¦åˆä»»åŠ¡ |

**ç»“è®º**ï¼šé•¿åº¦ç›¸è¿‘ï¼Œä½†å†…å®¹è´¨é‡å·®å¼‚å¤§

### BERTScoreå¯¹æ¯”ï¼ˆæ›´å¯é çš„è¯­ä¹‰æŒ‡æ ‡ï¼‰

| æ¨¡å‹ | Precision | Recall | F1 | 
|------|-----------|--------|-----|
| **Edge** | 0.1807 | 0.1500 | **0.1655** |
| **Cloud** | 0.2240 | 0.1645 | **0.1938** |

**å…³é”®å‘ç°**ï¼š
- âœ… **BERTScoreæ˜¾ç¤ºCloudæ˜æ˜¾æ›´å¥½**ï¼ˆ+17%ï¼‰
- âœ… BERTScoreè¡¡é‡**è¯­ä¹‰ç›¸ä¼¼åº¦**ï¼Œæ›´å‡†ç¡®åæ˜ è´¨é‡
- âŒ BLEU/CIDErè¢«è¡¨é¢n-gramåŒ¹é…è¯¯å¯¼

---

## ğŸ” å…·ä½“æ ·æœ¬å¯¹æ¯”

### Sample 00000000

**Reference** (åªçœ‹å…³é”®éƒ¨åˆ†):
```
"...è¡¨è¾¾å‡ºä¸æ»¡ä¸ä¸è€ã€‚ä¹‹åè¾¹ç¬‘è¾¹è¯´ï¼Œè¡¨è¾¾å‡ºé«˜å…´ä¸­å¸¦ç€ä¸€ä»½è°ƒä¾ƒã€‚..."
```

#### Edgeè¾“å‡º:
```
"è¯´è¯äººçš„å£°éŸ³æœ‰äº›ä½æ²‰ï¼ŒéŸ³é«˜å˜åŒ–ä¸å¤§ï¼Œè¯­æ°”å¹³ç¼“ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åœé¡¿æ—¶æ–­ï¼Œæ•´ä½“ç»™äººä¸€ç§å¹³é™çš„æ„Ÿè§‰ã€‚ä»–å¯èƒ½æ˜¯åœ¨è¡¨è¾¾ä¸€ç§æ— å¥ˆçš„æƒ…ç»ªã€‚ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•æˆ–è€…æƒ³è¡¥å……çš„ï¼Œéšæ—¶è·Ÿæˆ‘è¯´å“ˆã€‚"
```

- BLEU: 0.0275
- CIDEr: 0.5575
- **é—®é¢˜**ï¼šâŒ å¯¹è¯å¼ï¼Œä¸referenceè¯­ä¹‰ä¸ç¬¦ï¼ˆreferenceè¯´"ä¸æ»¡â†’é«˜å…´"ï¼Œè¾“å‡ºè¯´"å¹³é™â†’æ— å¥ˆ"ï¼‰

#### Cloudè¾“å‡º:
```
"è¯´è¯äººçš„è¯­æ°”å¬èµ·æ¥æœ‰äº›æ— å¥ˆå’Œå›°æƒ‘ï¼Œåƒæ˜¯åœ¨å›åº”åˆ«äººçš„é—®é¢˜æ—¶å‘ç°è‡ªå·±å¹¶ä¸æ¸…æ¥šç­”æ¡ˆã€‚ä»–çš„è¯è¯­é—´ä¼¼ä¹å¸¦ç€ä¸€ä¸ç´§å¼ ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿™ä¸ªé—®é¢˜å¯¹ä»–æ¥è¯´ç¡®å®æ¯”è¾ƒæ£˜æ‰‹ã€‚"
```

- BLEU: 0.0137
- CIDEr: 0.4723
- **ä¼˜åŠ¿**ï¼šâœ… å®¢è§‚æè¿°ï¼Œæ›´ç¬¦åˆä»»åŠ¡è¦æ±‚

---

### Sample 00000021

**Reference**:
```
"...éŸ³è°ƒæ—¶é«˜æ—¶ä½ï¼Œåœé¡¿çŸ­æš‚ï¼ŒèŠ‚å¥è¾ƒå¿«..."
```

#### Edgeè¾“å‡º:
```
"è¯´è¯äººçš„è¯­è°ƒå¹³ç¼“ï¼ŒéŸ³é«˜å˜åŒ–ä¸å¤§ï¼Œè¯­æ°”è½»æŸ”ï¼Œç»™äººä¸€ç§å¹³é™çš„æ„Ÿè§‰ã€‚å¯èƒ½æ˜¯å› ä¸ºä»–/å¥¹æ­£åœ¨å‡†å¤‡ä¸€ä¸ªé‡è¦çš„æ¼”è®²ã€‚ä½ è¦æ˜¯è¿˜æœ‰å…³äºè¿™æ–¹é¢çš„é—®é¢˜æˆ–è€…å…¶ä»–æƒ³æ³•ï¼Œéƒ½å¯ä»¥è·Ÿæˆ‘è¯´å“¦ã€‚"
```

- BLEU: 0.0128
- CIDEr: 0.5175
- **é—®é¢˜**ï¼šâŒ åˆæ˜¯å¯¹è¯å¼ï¼Œè¯­ä¹‰åå·®ï¼ˆreferenceè¯´"èŠ‚å¥å¿«"ï¼Œè¾“å‡ºè¯´"å¹³ç¼“"ï¼‰

#### Cloudè¾“å‡º:
```
"è¯´è¯äººçš„å£°éŸ³è½»æŸ”è€Œåšå®šï¼Œè¯­è°ƒå¹³ç¨³ä¸”å¯Œæœ‰èŠ‚å¥æ„Ÿï¼ŒéŸ³é«˜é€‚ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ³¢åŠ¨ã€‚ä»–çš„è¯è¯­é—´æ­‡çŸ­æš‚ï¼Œè¡¨è¾¾æ¸…æ™°è¿è´¯é€šç•…ï¼Œç»™äººä¸€ç§ä»å®¹ä¸è¿«çš„æ„Ÿè§‰ã€‚è¯´è¯äººåœ¨è°ˆè®ºæŸä¸ªè¯é¢˜æ—¶ï¼Œè¯­æ°”ä¸­é€éœ²å‡ºä¸€ç§æ·¡æ·¡çš„å¿§éƒå’ŒæœŸå¾…ï¼Œä¼¼ä¹åœ¨ç­‰å¾…ç€ä»€ä¹ˆé‡è¦çš„äº‹æƒ…å‘ç”Ÿã€‚"
```

- BLEU: 0.0190
- CIDEr: 0.5670
- **ä¼˜åŠ¿**ï¼šâœ… æ›´è¯¦ç»†ï¼Œæ›´ç¬¦åˆ"detailed"promptè¦æ±‚

---

## ğŸ’¡ å…³é”®é—®é¢˜æ€»ç»“

### 1. **Edgeæ¨¡å‹ç”Ÿæˆå¯¹è¯å¼å†…å®¹**

**åŸå› **ï¼š
- Edgeæ¨¡å‹æ²¡æœ‰è¢«å……åˆ†çº¦æŸï¼ˆæ— stopping criteriaï¼‰
- æ¨¡å‹é»˜è®¤å€¾å‘äºç”Ÿæˆå¯¹è¯å¼å›å¤

**è¯æ®**ï¼š
- å‡ ä¹æ‰€æœ‰Edgeè¾“å‡ºéƒ½ä»¥"ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•..."ç»“å°¾
- ä¸ç¬¦åˆä»»åŠ¡è¦æ±‚ï¼ˆåº”è¯¥æ˜¯å®¢è§‚æè¿°ï¼‰

### 2. **ç”Ÿæˆå‚æ•°å’Œåœæ­¢æ¡ä»¶ä¸ä¸€è‡´**

| æœºåˆ¶ | Edge | Cloud |
|------|------|-------|
| **Stopping criteria** | âŒ æ—  | âœ… 2å¥è¯+32 tokens |
| **Max tokens** | 64 | 120 |
| **è¾“å‡ºæ§åˆ¶** | ä»…max_tokens | å¤šé‡æ§åˆ¶ |

**ç»“æœ**ï¼š
- Edgeç”Ÿæˆåˆ°max_tokensæˆ–EOSï¼ˆå¯èƒ½åŒ…å«å¤šä½™å†…å®¹ï¼‰
- Cloudç²¾ç¡®æ§åˆ¶åœ¨2å¥è¯

### 3. **BLEU/CIDErä¸é€‚åˆè¡¡é‡é•¿æ–‡æœ¬è´¨é‡**

**å±€é™æ€§**ï¼š
- åªçœ‹n-gramè¡¨é¢åŒ¹é…
- ä¸è€ƒè™‘è¯­ä¹‰ç›¸ä¼¼åº¦
- æ›´é•¿çš„è¾“å‡ºæœ‰æ›´å¤šåŒ¹é…æœºä¼šï¼ˆå³ä½¿æ˜¯é”™è¯¯å†…å®¹ï¼‰

**æ›´å¥½çš„æŒ‡æ ‡**ï¼š
- **BERTScore**ï¼šCloudæ¯”Edgeé«˜17% (0.1938 vs 0.1655)
- è¯­ä¹‰çº§åˆ«çš„è¯„ä¼°

---

## ğŸ”§ ä¿®å¤å»ºè®®

### æ–¹æ¡ˆ1: è®©Edgeä¹Ÿä½¿ç”¨Stopping Criteriaï¼ˆæ¨èï¼‰

#### ä¿®æ”¹ `src/models/edge_model.py`

```python
def generate_draft(self, 
                  audio_features: torch.Tensor,
                  prompt: str = "...",
                  max_new_tokens: int = 32,
                  temperature: float = 0.7,
                  top_p: float = 0.9,
                  use_streaming: bool = True,
                  prompt_type: str = "default") -> tuple[str, dict]:  # âœ… æ·»åŠ prompt_type
    
    # âœ… æ·»åŠ stopping criteriaï¼ˆä¸Cloudä¸€è‡´ï¼‰
    from .stopping_criteria import create_stopping_criteria
    stopping_criteria = create_stopping_criteria(
        self.processor.tokenizer,
        n_sentences=2,
        sentence_end_chars=("ã€‚", "."),
        min_new_tokens=32,
        prompt_type=prompt_type
    )
    
    # ç”Ÿæˆæ—¶ä½¿ç”¨
    outputs = self.model.generate(
        **inputs,
        max_new_tokens=max_new_tokens,
        temperature=temperature,
        top_p=top_p,
        do_sample=False,
        no_repeat_ngram_size=2,
        repetition_penalty=1.05,
        stopping_criteria=stopping_criteria,  # âœ… æ·»åŠ 
        pad_token_id=self.processor.tokenizer.eos_token_id,
    )
```

#### ä¿®æ”¹ `experiments/runs/run_edge_baseline_cpu_limited.py`

```python
# ç¬¬449è¡Œ
generated_text, detailed_latency = edge_model.generate_draft(
    audio_waveform, 
    prompt_template, 
    max_new_tokens=120,  # âœ… æ”¹ä¸º120ï¼ˆä¸Cloudä¸€è‡´ï¼‰
    prompt_type=prompt_type  # âœ… ä¼ é€’prompt_type
)
```

---

### æ–¹æ¡ˆ2: ç»Ÿä¸€æ‰€æœ‰ç”Ÿæˆå‚æ•°

| å‚æ•° | å»ºè®®å€¼ | ç†ç”± |
|------|--------|------|
| **max_new_tokens** | 120 | è¶³å¤Ÿç”Ÿæˆ2-3å¥è¯ |
| **temperature** | 0.7 | é€‚åº¦éšæœºæ€§ |
| **top_p** | 0.9 | æ ‡å‡†nucleus sampling |
| **do_sample** | False | è´ªå¿ƒè§£ç ï¼Œç¡®å®šæ€§è¾“å‡º |
| **no_repeat_ngram_size** | 2 | é˜²æ­¢2-gramé‡å¤ |
| **repetition_penalty** | 1.05 | è½»åº¦é‡å¤æƒ©ç½š |
| **stopping_criteria** | âœ… 2å¥è¯+32 tokens | **å…³é”®**ï¼šä¿è¯è¾“å‡ºæ ¼å¼ä¸€è‡´ |

---

### æ–¹æ¡ˆ3: ä¿®å¤Promptï¼ˆå¯é€‰ï¼‰

å½“å‰promptå¯èƒ½ä¸å¤Ÿæ˜ç¡®ï¼Œå¯¼è‡´æ¨¡å‹ç”Ÿæˆå¯¹è¯å¼å›å¤ã€‚

#### å½“å‰"detailed" prompt:

```python
"ä»»åŠ¡ï¼šè¯·ç”Ÿæˆ"æƒ…æ„Ÿè¯´æ˜é•¿å¥"ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºç»„ç»‡å†…å®¹å¹¶ä¿æŒè‡ªç„¶æµç•…ï¼š
(1) å…ˆç”¨2â€“3ä¸ª"ç±»åˆ«çº§"çš„å£°å­¦/éŸµå¾‹çº¿ç´¢æè¿°è¯´è¯æ–¹å¼...
(2) æ®æ­¤ç»™å‡ºæœ€å¯èƒ½çš„å•ä¸€æƒ…ç»ª...
(3) è‹¥è¯­ä¹‰å†…å®¹æš—ç¤ºç¼˜ç”±ï¼Œå¯ç”¨æç®€çš„ä¸€å°çŸ­è¯­ç‚¹åˆ°ä¸ºæ­¢...

è¾“å‡ºè¦æ±‚ï¼š
- åªè¾“å‡º"ä¸¤åˆ°ä¸‰å¥ä¸­æ–‡é•¿å¥"ï¼Œçº¦70â€“100ä¸ªå­—ï¼›
- ä½¿ç”¨ç¬¬ä¸‰äººç§°æˆ–"è¯´è¯äºº"ç­‰æŒ‡ä»£ï¼›ä¸è¦å‡ºç°ç¬¬ä¸€/ç¬¬äºŒäººç§°ï¼›ä¸è¦è®¾é—®æˆ–é‚€è¯·å¯¹è¯ï¼›
- ..."
```

**é—®é¢˜**ï¼šå·²ç»æ˜ç¡®è¦æ±‚"ä¸è¦è®¾é—®æˆ–é‚€è¯·å¯¹è¯"ï¼Œä½†Edgeæ¨¡å‹ä»ç„¶è¿å

**å¯èƒ½åŸå› **ï¼š
- Edgeæ¨¡å‹ï¼ˆ3Bï¼‰å¯¹promptéµå¾ªèƒ½åŠ›è¾ƒå¼±
- **è§£å†³**ï¼šå¿…é¡»ç”¨stopping criteriaå¼ºåˆ¶çº¦æŸ

---

## ğŸ“Š é¢„æœŸä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ï¼ˆå½“å‰ï¼‰

| æ¨¡å‹ | BLEU | CIDEr | BERTScore F1 | è¾“å‡ºè´¨é‡ |
|------|------|-------|--------------|----------|
| **Edge** | 0.0305 | 0.5097 | 0.1655 | âŒ å¯¹è¯å¼ï¼Œä¸ç¬¦åˆè¦æ±‚ |
| **Cloud** | 0.0239 | 0.4967 | **0.1938** | âœ… å®¢è§‚ï¼Œç¬¦åˆè¦æ±‚ |

### ä¿®å¤åï¼ˆé¢„æœŸï¼‰

| æ¨¡å‹ | BLEU | CIDEr | BERTScore F1 | è¾“å‡ºè´¨é‡ |
|------|------|-------|--------------|----------|
| **Edge** | ~0.020 | ~0.45 | ~0.16 | âœ… å®¢è§‚ï¼Œç¬¦åˆè¦æ±‚ |
| **Cloud** | ~0.024 | ~0.50 | **~0.19** | âœ… å®¢è§‚ï¼Œç¬¦åˆè¦æ±‚ï¼Œæ›´å¥½ |

**å…³é”®ç‚¹**ï¼š
- Edgeçš„BLEU/CIDErä¼š**ä¸‹é™**ï¼ˆå› ä¸ºåˆ é™¤äº†å¤šä½™çš„å¯¹è¯å¼å†…å®¹ï¼‰
- ä½†è¾“å‡º**è´¨é‡æå‡**ï¼ˆç¬¦åˆä»»åŠ¡è¦æ±‚ï¼‰
- Cloudåº”è¯¥åœ¨**æ‰€æœ‰æŒ‡æ ‡**ä¸Šéƒ½ä¼˜äºEdgeï¼ˆç¬¦åˆç›´è§‰ï¼‰

---

## ğŸ¯ æ ¸å¿ƒç»“è®º

### å½“å‰é—®é¢˜çš„æœ¬è´¨

**ä¸æ˜¯Cloudæ¨¡å‹å·®ï¼Œè€Œæ˜¯Edgeæ¨¡å‹"ä½œå¼Š"äº†ï¼**

1. **Edgeç”Ÿæˆäº†é”™è¯¯æ ¼å¼çš„å†…å®¹**ï¼ˆå¯¹è¯å¼ï¼‰
2. **BLEU/CIDErè¢«è¯¯å¯¼**ï¼ˆæ›´å¤šn-gramåŒ¹é…â‰ æ›´å¥½çš„è´¨é‡ï¼‰
3. **BERTScoreæ­ç¤ºçœŸç›¸**ï¼šCloudè¯­ä¹‰è´¨é‡æ›´å¥½ï¼ˆ+17%ï¼‰

### çœŸæ­£çš„è§£å†³æ–¹æ¡ˆ

**ç»Ÿä¸€ç”Ÿæˆæœºåˆ¶**ï¼š
- âœ… ç›¸åŒçš„stopping criteria
- âœ… ç›¸åŒçš„max_new_tokens
- âœ… ç›¸åŒçš„generationå‚æ•°

**åªæœ‰å‚æ•°ä¸€è‡´ï¼Œæ¯”è¾ƒæ‰æœ‰æ„ä¹‰ï¼**

---

## ğŸ§ª ä¿®å¤æ­¥éª¤

### Step 1: ä¿®æ”¹Edgeæ¨¡å‹

1. æ·»åŠ `prompt_type`å‚æ•°åˆ°`generate_draft`
2. å¯¼å…¥å¹¶ä½¿ç”¨`create_stopping_criteria`
3. åœ¨`model.generate()`ä¸­æ·»åŠ `stopping_criteria`å‚æ•°

### Step 2: ä¿®æ”¹Edge baseline runner

1. ä¼ é€’`prompt_type`åˆ°`edge_model.generate_draft()`
2. æ”¹`max_new_tokens=64` â†’ `max_new_tokens=120`

### Step 3: é‡æ–°è¿è¡Œå®éªŒ

```bash
python experiments/runs/run_edge_baseline_cpu_limited.py \
    --dataset_type unified \
    --dataset_path data/processed/mer2024/manifest_audio_only_final.json \
    --caption_type audio_only \
    --language chinese \
    --prompt_type detailed \
    --max_samples 100
```

### Step 4: éªŒè¯ç»“æœ

**é¢„æœŸ**ï¼š
- Edgeè¾“å‡ºä¸å†åŒ…å«"ä½ è¦æ˜¯è¿˜æœ‰å•¥æƒ³æ³•..."
- Edgeçš„BLEU/CIDErå¯èƒ½ä¸‹é™ï¼ˆæ­£å¸¸ï¼‰
- Cloudåœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šä¼˜äºEdgeï¼ˆç¬¦åˆç›´è§‰ï¼‰
- ä¸¤è€…çš„è¾“å‡ºæ ¼å¼ä¸€è‡´ï¼ˆéƒ½æ˜¯2-3å¥å®¢è§‚æè¿°ï¼‰

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### Edgeæ¨¡å‹ä¸ºä»€ä¹ˆå€¾å‘ç”Ÿæˆå¯¹è¯å¼å†…å®¹ï¼Ÿ

**å¯èƒ½åŸå› **ï¼š
1. **é¢„è®­ç»ƒæ•°æ®**ï¼šQwen2.5-Omniåœ¨å¯¹è¯æ•°æ®ä¸Šè®­ç»ƒ
2. **æ¨¡å‹è§„æ¨¡**ï¼š3Bå‚æ•°è¾ƒå°ï¼Œinstruction followingèƒ½åŠ›è¾ƒå¼±
3. **ç¼ºä¹çº¦æŸ**ï¼šæ²¡æœ‰stopping criteriaå¼ºåˆ¶é™åˆ¶è¾“å‡ºæ ¼å¼

**Cloudæ¨¡å‹ä¸ºä»€ä¹ˆèƒ½é¿å…ï¼Ÿ**
1. **æ›´å¤§è§„æ¨¡**ï¼š7Bå‚æ•°ï¼Œæ›´å¥½çš„instruction following
2. **Stopping criteria**ï¼šå¼ºåˆ¶é™åˆ¶åœ¨2å¥è¯
3. **Promptéµå¾ª**ï¼šæ›´å‡†ç¡®ç†è§£"ä¸è¦å¯¹è¯"çš„è¦æ±‚

---

## æ€»ç»“

æ‚¨çš„è§‚å¯Ÿéå¸¸æ­£ç¡®ï¼**Cloudæ¨¡å‹ç†åº”æ¯”Edgeæ¨¡å‹è¡¨ç°æ›´å¥½**ã€‚

**å½“å‰ç»“æœåå¸¸çš„åŸå› **ï¼š
1. âŒ Edgeæ¨¡å‹ç”Ÿæˆäº†å¯¹è¯å¼å†…å®¹ï¼ˆä¸ç¬¦åˆä»»åŠ¡è¦æ±‚ï¼‰
2. âŒ Edgeæ¨¡å‹æ²¡æœ‰ä½¿ç”¨stopping criteriaï¼ˆç”Ÿæˆå‚æ•°ä¸ä¸€è‡´ï¼‰
3. âŒ BLEU/CIDErè¢«è¡¨é¢n-gramåŒ¹é…è¯¯å¯¼

**æ­£ç¡®çš„åšæ³•**ï¼š
1. âœ… ç»Ÿä¸€Edgeå’ŒCloudçš„ç”Ÿæˆå‚æ•°ï¼ˆå°¤å…¶æ˜¯stopping criteriaï¼‰
2. âœ… ä½¿ç”¨BERTScoreä½œä¸ºä¸»è¦è¯„ä¼°æŒ‡æ ‡ï¼ˆè¯­ä¹‰çº§åˆ«ï¼‰
3. âœ… ç¡®ä¿ä¸¤ä¸ªæ¨¡å‹éƒ½è¾“å‡ºç¬¦åˆä»»åŠ¡è¦æ±‚çš„æ ¼å¼

**ä¿®å¤å**ï¼ŒCloudåº”è¯¥åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šéƒ½ä¼˜äºEdgeï¼Œè¿™æ‰ç¬¦åˆç›´è§‰å’Œå®é™…æƒ…å†µï¼

